<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Faust architecture: faust2vcvrack</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Faust architecture
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_architecture_2vcvrack_2README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">faust2vcvrack</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md262"></a> The <b>faust2vcvrack</b> tool compiles a <a class="el" href="classFaust.html" title="Alchemy DSP.">Faust</a> DSP program in a folder containing the <a href="https://vcvrack.com">VCV Rack</a> plugin C++ source code and a Makefile to compile it. By default the resulting C++ code is compiled and installed in the VCV Rack application:</p>
<p><code>faust2vcvrack [-soundfile] [-source] [-nvoices &lt;num&gt;] [additional <a class="el" href="classFaust.html" title="Alchemy DSP.">Faust</a> options (-vec -vs 8...)] &lt;file.dsp&gt;</code></p>
<p>Here are the available options:</p>
<ul>
<li>&lsquo;-soundfile when compiling a DSP using the 'soundfile&rsquo; primitive, add required resources<code> -</code>-source to only create the source folder<code> -</code>-nvoices &lt;num&gt; to produce a polyphonic self-contained DSP with &lt;num&gt; voices, ready to be used with MIDI<code> -</code>-version &lt;1|2&gt; : to set the plugin version, 1 by default`</li>
</ul>
<p><a class="el" href="classFaust.html" title="Alchemy DSP.">Faust</a> DSP code classically produces audio signals in the [-1..1] range. Since VCV expect audio signals in the [-5v..5v] range, they are <b>automatically converted in the architecture file</b>. CV control in the [0v..10v] range will be mapped to the controllers [min..max] range.</p>
<h1><a class="anchor" id="autotoc_md263"></a>
Polyphony support</h1>
<p>Polyphonic modules can be created using the <code>-nvoices &lt;num&gt;</code> parameter up to 16 voices. The <code>freq/gate/gain</code> convention can be used in the DSP code. VCV Rack follows the 1V/octave convention for MIDI pitch values, so the MIDI signals are automatically converted to <code>freq</code> using this convention. Gain and gates signals (using the [0v..10v] range) are converted to [0..1] values.</p>
<p>Note that <b>creating polyphonic effects</b> also makes sense in VCV Rack. For instance a reverb connected to a polyphonic instrument would need to be polyphonic. Thus the <code>-nvoices &lt;num&gt;</code> parameter can also be used in this case.</p>
<h1><a class="anchor" id="autotoc_md264"></a>
Metadata</h1>
<p>Controllers (typically <em>buttons</em>, <em>sliders</em>, <em>nentry</em> or <em>bargraph</em>) will be automatically transformed in <a class="el" href="classGUI.html">GUI</a> items (like switches, knobs or lights). But they can alternatively be connected to CV inputs/outputs using a metadata:</p>
<ul>
<li><code>[CV:N]</code> can be used in input (typically <em>sliders</em> or <em>nentry</em>) or output (typically <em>bargraph</em>) controllers to connect them to CV instead of regular <a class="el" href="classGUI.html">GUI</a> parameters.</li>
</ul>
<h1><a class="anchor" id="autotoc_md265"></a>
DSP examples</h1>
<p>Here is a simple example showing how oscillators can be controlled by <a class="el" href="structUI.html">UI</a> items. One switch, one button and two knobs will be created in the <a class="el" href="classGUI.html">GUI</a>:</p>
<div class="fragment"><div class="line">import(&quot;stdfaust.lib&quot;);</div>
<div class="line"> </div>
<div class="line">freq = hslider(&quot;freq&quot;, 200, 50, 5000, 0.01);</div>
<div class="line">gain = hslider(&quot;gain&quot;, 0.5, 0, 1, 0.01);</div>
<div class="line">gate = button(&quot;gate&quot;);</div>
<div class="line">check = checkbox(&quot;check&quot;);</div>
<div class="line"> </div>
<div class="line">// DSP processor</div>
<div class="line">process = os.osc(freq) * gain * gate, os.sawtooth(freq) * gain * check;</div>
</div><!-- fragment --><p>A polyphonic instrument with <code>freq/gate/gain</code> controllers associated with CV MIDI inputs, using the <code>[CV:N]</code> metadata, to be compiled with the <code>-nvoices &lt;num&gt;</code> option:</p>
<div class="fragment"><div class="line">import(&quot;stdfaust.lib&quot;);</div>
<div class="line"> </div>
<div class="line">// control variables</div>
<div class="line">master = hslider(&quot;master&quot;, 0.3, 0, 2, 0.01);    </div>
<div class="line">pan = hslider(&quot;pan&quot;, 0.5, 0, 1, 0.01);    </div>
<div class="line"> </div>
<div class="line">freq = nentry(&quot;freq [CV:1]&quot;, 440, 20, 20000, 1);    </div>
<div class="line">gain = nentry(&quot;gain [CV:3]&quot;, 0.3, 0, 10, 0.01);    </div>
<div class="line">gate = button(&quot;gate [CV:2]&quot;);            </div>
<div class="line"> </div>
<div class="line">// relative amplitudes of the different partials</div>
<div class="line">amp(1) = hslider(&quot;amp1&quot;, 1.0, 0, 3, 0.01);</div>
<div class="line">amp(2) = hslider(&quot;amp2&quot;, 0.5, 0, 3, 0.01);</div>
<div class="line">amp(3) = hslider(&quot;amp3&quot;, 0.25, 0, 3, 0.01);</div>
<div class="line"> </div>
<div class="line">// panner function</div>
<div class="line">panner(pan, x) = x*sqrt(1-pan), x*sqrt(pan);</div>
<div class="line"> </div>
<div class="line">// additive synth: 3 sine oscillators with adsr envelop</div>
<div class="line">partial(i) = amp(i+1)*os.osc((i+1)*freq);</div>
<div class="line"> </div>
<div class="line">process = sum(i, 3, partial(i))</div>
<div class="line">* (gate : vgroup(&quot;1-adsr&quot;, en.adsr(0.05, 0.1, 0.1, 0.1)))</div>
<div class="line">* gain : vgroup(&quot;2-master&quot;, *(master) : panner(pan));</div>
</div><!-- fragment --><p>This polyphonic instrument can then be connected to a polyphonic reverb, to be also compiled with the <code>-nvoices &lt;num&gt;</code> option:</p>
<div class="fragment"><div class="line">import(&quot;stdfaust.lib&quot;);</div>
<div class="line">process = dm.freeverb_demo;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
