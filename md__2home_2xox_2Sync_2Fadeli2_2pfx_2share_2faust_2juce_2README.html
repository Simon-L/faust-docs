<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Faust architecture: faust2juce</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Faust architecture
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">faust2juce</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md347"></a> The <b>faust2juce</b> tool transforms a <a class="el" href="classFaust.html">Faust</a> DSP program into a fully working JUCE standalone application or plugin, which can possibly be controlled with MIDI or OSC messages. Polyphonic instruments are automatically created from polyphonic aware <a class="el" href="classFaust.html">Faust</a> DSP code, which contains interface parameters with the following <code>freq</code>, <code>gain</code> and <code>gate</code> names. The metadata <b>declare nvoices "8";</b> kind of line with a desired value of voices can be added in the source code. See <a href="https://faustdoc.grame.fr/manual/midi/#midi-polyphony-support">Creating polyphonic instruments</a>.</p>
<p>Polyphonic synthesiser can be created using JUCE Synthesiser model or <a class="el" href="classFaust.html">Faust</a> own polyphonic architecture file (using the <code><a class="el" href="classmydsp__poly.html">mydsp_poly</a></code> class). The <code>-jsynth</code> parameter has to be used to choose the JUCE model.</p>
<p><b>faust2juce</b> uses several <a class="el" href="structUI.html">UI</a> interfaces, subclasses of the base <a class="el" href="structUI.html">UI</a> class (defined in the architecture/faust/gui/UI.h header) to link to various JUCE components:</p>
<ul>
<li><code><a class="el" href="JuceGUI_8h_source.html">JuceGUI.h</a></code>: contains the main <a class="el" href="classJuceGUI.html">JuceGUI</a> class (and additional helpers classes) to display <a class="el" href="classFaust.html">Faust</a> <a class="el" href="structUI.html">UI</a> components (buttons, sliders, bargraphs...) using JUCE widgets. The following <code>[style:knob]</code>, <code>[style:led]</code>, <code>[style:numerical]</code>, <code>[style:radio]</code>, <code>[style:menu]</code>, <code>[scale:log]</code>, <code>[scale:exp]</code>, <code>[tooltip:xx]</code>, <code>[hidden:0|1]</code> metadata are supported.</li>
<li><code><a class="el" href="JuceOSCUI_8h_source.html">JuceOSCUI.h</a></code>: allows to link <a class="el" href="classFaust.html">Faust</a> <a class="el" href="structUI.html">UI</a> components (buttons, sliders, bargraphs...) to the JUCE OSC messaging system, allowing to control them in both directions</li>
<li><code><a class="el" href="JuceParameterUI_8h_source.html">JuceParameterUI.h</a></code>: allows to link <a class="el" href="classFaust.html">Faust</a> <a class="el" href="structUI.html">UI</a> components (buttons, sliders, bargraphs...) with the JUCE AudioParameterFloat/AudioParameterBool classes</li>
<li><code><a class="el" href="JuceStateUI_8h_source.html">JuceStateUI.h</a></code>: allows to save/restore <a class="el" href="classFaust.html">Faust</a> <a class="el" href="structUI.html">UI</a> components (buttons, sliders, bargraphs...) values using the JUCE state management system (MemoryInputStream/MemoryOutputStream classes)</li>
</ul>
<p>Some additional files are needed for soundfile and MIDI support:</p>
<ul>
<li><code><a class="el" href="JuceReader_8h_source.html">JuceReader.h</a></code>: contains code to load audio files using JUCE code, that will be used when the <code>soundfile</code> primitive is used in the <a class="el" href="classFaust.html">Faust</a> code</li>
<li><code><a class="el" href="juce-midi_8h_source.html">juce-midi.h</a></code>: allows to link <a class="el" href="classFaust.html">Faust</a> <a class="el" href="structUI.html">UI</a> components (buttons, sliders, bargraphs...) to the JUCE MIDI messaging system (for inputs and outputs)</li>
</ul>
<p>Two different achitecture files will be used to glue the previously described files with the <a class="el" href="classFaust.html">Faust</a> C++ generated class:</p><ul>
<li><code>juce-plugin.cpp</code>: is used to create a JUCE plugin</li>
<li><code>juce-standalone.cpp</code>: is used to create a JUCE stanalone application</li>
</ul>
<h1><a class="anchor" id="autotoc_md348"></a>
How to use</h1>
<p><b>faust2juce</b> is used with the following command:</p>
<p><code>faust2juce [-osc] [-midi] [-soundfile] [-nvoices &lt;num&gt;] [-effect auto|&lt;effect.dsp&gt;] [-standalone] [-jucemodulesdir &lt;dir&gt;] [-vst2sdkdir &lt;dir&gt;] [-disable-splash-screen] [-jsynth] [-llvm] [-magic] [additional <a class="el" href="classFaust.html">Faust</a> options (-vec -vs 8...)] file.dsp</code></p>
<p>By default it will create a plugin project, with a folder named with the dsp file name, containing a .jucer project with a FaustPluginProcessor.cpp file to be used by JUCE.</p>
<p>When using <code>-standalone</code> mode, it will create a standalone project, with a folder named with the dsp file name, containing a .jucer project with a FaustAudioApplication.cpp file to be used by JUCE.</p>
<p>The resulting folder has to be moved on the "examples" folder of your JUCE installation, the .jucer file has to be opened, and projects for specific native platforms can be generated. Using the <code>-jucemodulesdir</code> allows to generate projects that can be used without moving them in JUCE installation.</p>
<h1><a class="anchor" id="autotoc_md349"></a>
Options</h1>
<p>Here are the available options:</p>
<ul>
<li><code>-osc</code> : activates OSC control</li>
<li><code>-midi</code> : activates MIDI control</li>
<li><code>-soundfile</code> : when compiling DSP using 'soundfile' primitive, to add needed resources</li>
<li><code>-nvoices &lt;num&gt;</code> : to produce a polyphonic self-contained DSP with &lt;num&gt; voices, ready to be used with MIDI or OSC</li>
<li><code>-effect &lt;effect.dsp&gt;</code> : to produce a polyphonic DSP connected to a global output effect, ready to be used with MIDI or OSC</li>
<li><code>-effect auto</code> : to produce a polyphonic DSP connected to a global output effect defined as 'effect' in &lt;file.dsp&gt;, ready to be used with MIDI or OSC</li>
<li><code>-standalone</code> : to produce a standalone project, otherwise a plugin project is generated</li>
<li><code>-jucemodulesdir &lt;folder&gt;</code> : to set JUCE modules directory to <code>&lt;folder&gt;</code>, such as ~/JUCE/modules</li>
<li><code>-vst2sdkdir &lt;folder&gt;</code> : to set VST 2 Legacy Directory to <code>&lt;folder&gt;</code>. This is the directory that contains "plugininterfaces/vst2.x/aeffect.h".</li>
<li><code>-disable-splash-screen</code> : to disable the JUCE splash screen (license is required).</li>
<li><code>-jsynth</code> : to use JUCE polyphonic Synthesizer instead of <a class="el" href="classFaust.html">Faust</a> polyphonic code </li>
</ul>
<h1><a class="anchor" id="autotoc_md350"></a>
- &lt;tt&gt;-llvm&lt;/tt&gt; : to use the LLVM compilation chain (OSX and Linux for now)</h1>
<ul>
<li><code>-magic</code> : to generate a project using the <a href="https://foleysfinest.com/developer/pluginguimagic/">PluginGuiMagic GUI builder</a> Tested with PGM version 1.13. Support for <a class="el" href="classFaust.html">Faust</a> components is incomplete. Supporting some features (e.g. visualizers) in PGM requires editing the generated C++ code.</li>
</ul>
<p>This creates a preprocessor definition "PLUGIN_MAGIC" in the jucer file e.g. using VisualStudio 2019.</p>
<p><img src="https://user-images.githubusercontent.com/3178344/125528513-d8f127a0-a896-4f50-8210-ba7b8dcf0386.png" alt="image" class="inline"/></p>
<p>There are a couple of other options as well:</p>
<p>MAGIC_LOAD_BINARY</p><ul>
<li><p class="startli">adds generated code if defined. By default not defined, lets you "bake in" your XML file by adding it to your Jucer project and then defining this variable. You'll also need to configure the foleys_gui_magic module in Jucer:</p>
<p class="startli"><img src="https://user-images.githubusercontent.com/3178344/126184481-b83ba2ff-46c4-4aa5-b010-2d2e87eb4e14.png" alt="image" class="inline"/></p>
<p class="startli">You also have to change the names of the variables magic_xml and magic_xmlSize in the code to match your file name. If you don't you'll get a compilation error, so you'll know where to look.</p>
</li>
</ul>
<p>MAGIC_LEVEL_SOURCE</p><ul>
<li>adds generated code if defined. By default not defined, just to show you where in the source code you would add hooks for a visualizer. These are PGM specific features not represented in <a class="el" href="classFaust.html">Faust</a>. Knowledge of how to use the PGM components is assumed.</li>
</ul>
<p>To use either of these options, either enter the option into the JUCER exporter settings page as shown, or add a <code>#define</code> line near the top of your FaustPluginProcessor.cpp.</p>
<hr  />
<ul>
<li><code>-help or -h</code> : shows the different options</li>
</ul>
<p>As usual with faust2xx tools, other <a class="el" href="classFaust.html">Faust</a> compiler specific options can be given to <b>faust2juce</b>, like <code>-vec -lv 1</code> to compile in vector mode.etc.</p>
<h1><a class="anchor" id="autotoc_md352"></a>
Latency setting</h1>
<p>Some plugins add latency in the signal path. A special global metadata can be used in the DSP code to define it, so that the C++ architecture file can extract it and use the JUCE <code>AudioProcessor::setLatencySamples()</code> method to have the plugin inform the host about its added latency. The following syntax can be used:</p>
<ul>
<li><code>declare latency_frames "7000";</code> (or alternatively <code>declare latency_samples "7000";</code>) to express the latency in samples/frames</li>
<li><code>declare latency_sec "0.5";</code> to express the latency in seconds, to be converted internally in samples/frames using the host sample rate </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
